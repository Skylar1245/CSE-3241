SELECT Person.Fname, Person.Lname, SUM(Rental.Quantity)
FROM Person, Community_Member, Rental
WHERE Rental.member = Community_Member.User_ID AND Community_Member.User_ID = Person.ID_No
GROUP BY Person.Lname




WITH Rental_Count AS
( SELECT Person.Id_No, Person.Fname, Person.Lname, COUNT(Rental.Rental_No) AS Rental_Num
FROM Person
INNER JOIN Community_Member ON Community_Member.User_ID = Person.ID_No
INNER JOIN Rental ON Rental.member = Community_Member.User_ID
GROUP BY Person.Id_No, Person.Fname, Person.Lname ),

Avg_Rental AS
(SELECT AVG(Rental_Num) AS average_rent_num
FROM Rental_Count )

SELECT Rental_Count.Fname, Rental_Count.Lname, Person.email
FROM Rental_Count
CROSS JOIN Avg_Rental
JOIN Person ON Rental_Count.ID_No = Person.ID_No
WHERE Avg_Rental.average_rent_num < Rental_Count.Rental_Num





SELECT Inventory.Inventory_Name, SUM(Rental.Rental_no)
FROM Equipment, Rental, Inventory
WHERE Equipment.Serial_No = Rental.item AND Equipment.Serial_No = Inventory.Serial_No
GROUP BY Inventory.Inventory_Name
ORDER BY SUM(Rental.Rental_no) DESC






SELECT Drone.Serial_no, Inventory.Inventory_Name, SUM(Drone.dist_auto) AS Dist_Sum
FROM Drone, Inventory
WHERE Inventory.Serial_No = Drone.Serial_No
GROUP BY Drone.Serial_No, Inventory.Inventory_Name
ORDER BY Dist_Sum DESC





SELECT Manufacturer.cname, COUNT (Rental.Rental_no) AS Num_Rentals
FROM Manufacturer, Rental, Inventory
WHERE Manufacturer.Cname = Inventory.Manufacturer AND Inventory.Serial_No = Rental.drone
GROUP BY Manufacturer.Cname
ORDER BY Num_Rentals DESC






SELECT Inventory.Serial_No, SUM(Rental.Duration) AS Total_duration, COUNT(Rental.Rental_no)
	FROM Inventory, Rental
	WHERE Inventory.Serial_No = Rental.Item OR Inventory.Serial_No = Rental.Drone
GROUP BY Inventory.Serial_No
ORDER BY Total_Duration







SELECT Person.Fname, Person,Lname, Person.Phone
FROM Person, Community_Member
WHERE Person.Id_No = Community_Member.User_ID
JOIN Most_Rented

Most_Rented AS (SELECT Rental.Rental_No, COUNT(Rental_No) AS Demand
FROM Rental
GROUP BY Rental.Rental_No
ORDER BY Demand DESC)






WITH Member_Rentals AS (
SELECT Rental.member, COUNT(*) AS Rental_Count
FROM Rental
JOIN Community_Member ON Community_Member.User_ID = Rental.member
GROUP BY Rental.member),

Avg_Rental AS (
SELECT AVG(Rental_Count) AS avg_rental_count
FROM Member_Rentals)

SELECT DISTINCT Inventory.Manufacturer
FROM Rental
JOIN Inventory ON Inventory.Serial_No = Rental.DRONE
JOIN Member_Rentals ON Member_Rentals.member = Rental.member
JOIN Avg_Rental ON Avg_Rental.avg_rental_count < Member_Rentals.Rental_Count
